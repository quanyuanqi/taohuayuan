<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Advices</title>
</head>
<body>
<h1>Submit New Post</h1>
<input id="title" placeholder="Title"><br>
<textarea id="content" placeholder="HTML content"></textarea><br>
<button onclick="submitPost()">Submit Post</button>

<h2>Posts</h2>
<div id="posts"></div>

<script>
const WORKER_URL = "https://tiny-haze-9454.jamic2003.workers.dev";

// Submit post
async function submitPost(){
  const title=document.getElementById("title").value;
  const content=document.getElementById("content").value;
  await fetch(`${WORKER_URL}/api/post`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({title, content})
  });
  alert("Submitted for review!");
  loadPosts();
}

// Load approved posts
async function loadPosts(){
  const res=await fetch(`${WORKER_URL}/api/posts`);
  const files=await res.json();
  const container=document.getElementById("posts");
  container.innerHTML="";
  for(const f of files){
    const postRes=await fetch(`${WORKER_URL}/post/${f}`);
    const html=await postRes.text();
    const div=document.createElement("div");
    div.innerHTML=html;
    container.appendChild(div);
  }
}

loadPosts();
</script>
</body>
</html>
